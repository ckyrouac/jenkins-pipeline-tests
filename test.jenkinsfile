node {
  stage("test") {
    checkout(scm)
    sh("git checkout master")
    sh("git fetch origin && git reset --hard origin/master")
    HEAD = sh (
        script: "git rev-parse HEAD",
        returnStdout: true
    ).trim()
    echo "HEAD: ${HEAD}"
    
    PREVIOUS_BUILD = currentBuild.getPreviousBuild().description
    def scmAction = PREVIOUS_BUILD?.actions.find { action -> action instanceof jenkins.scm.api.SCMRevisionAction }
    def commitHash = scmAction?.revision?.hash
    echo "PREVIOUS_BUILD: ${commitHash}"
  }
}
